= content_for :head do
  = stylesheet_link_tag    "codemirror-3.12/lib/codemirror.css"
  = javascript_include_tag "//ajax.googleapis.com/ajax/libs/angularjs/1.0.7/angular.min.js"
  = javascript_include_tag "//ajax.googleapis.com/ajax/libs/angularjs/1.0.7/angular.min.js"
= content_for :project do
  %h2= current_project.name

:javascript
  function project($scope, $http){
    $scope.tasks = #{tasks};
    $scope.notes = [ {"body":"hello"} ];

    $scope.showNotes = function(task_id){
      var promise = $http.get('/tasks/'+task_id+'/notes');
      promise.success(function(json) {
        $scope.notes = json;
      });
    }
  };

#project(ng-app ng-controller="project")
  %section#editor
  %section#tasks
    %ul(ng-repeat="task in tasks")
      %li
        {{task.name}}
        .actions
          = link_to "notes", "#", "ng-click" => "showNotes(task.id)"
  %section#notes
    %ul.notes(ng-repeat="note in notes")
      %li
        %p.note(ng-bind="note.body")
